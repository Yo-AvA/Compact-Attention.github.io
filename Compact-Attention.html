<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
    <!-- Replace the content tag with appropriate information -->
    <meta name="description" content="Huawei">
    <meta property="og:title" content="Huawei" />
    <meta property="og:description" content="Huawei" />

    <!-- Keywords for your paper to be indexed by-->
    <meta name="keywords" content="Huawei">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>华为火花-超长序列视频推理加速</title>
    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="static/css/bulma.min.css">
    <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="static/css/index.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/dreampulse/computer-modern-web-font@master/fonts.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
    <script defer src="static/js/fontawesome.all.min.js"></script>
    <script src="static/js/bulma-carousel.min.js"></script>
    <script src="static/js/bulma-slider.min.js"></script>
    <script src="static/js/index.js"></script>

    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_SVG"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$','$'], ['\\(','\\)']],
                displayMath: [['$$', '$$'], ['\\[','\\]']]
            }
        });
    </script>

    <style>
        .centered-content {
            text-align: center;
        }
        .video-container {
            width: 90%; 
            margin: 0 auto; 
            display: flex; /* Use flexbox to arrange videos side by side */
            justify-content: center; /* Center the videos horizontally */
            gap: 20px; /* Add space between videos */
        }
        .italic {
            font-family: 'Playfair Display';
            font-style: italic;
        }
        
        /* 设置表格宽度和字体大小 */
        table {
            width: 80%; /* 设置表格的宽度为容器的80% */
            margin: 0 auto; /* 将表格居中 */
            border-collapse: collapse; /* 合并表格的边框 */
            font-size: 18px; /* 设置字体大小 */
        }

        /* 设置表头的样式 */
        th, td {
            padding: 12px; /* 增加单元格的内边距 */
            text-align: center; /* 设置文字居中对齐 */
            border: 1px solid black; /* 设置边框 */
        }

        /* 设置表头的背景色 */
        thead {
            background-color: #f2f2f2; /* 设置表头的背景颜色 */
        }
        body {
            padding-bottom: 100px;  /* 留100px的底部空白 */
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .section {
            background: #fff;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .section h2 {
            font-size: 1.2em;
            color: #333;
            margin-bottom: 10px;
        }
        .section table {
            font-family: "Times New Roman", serif;
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            font-size: 0.9em; /* 设置字体大小 */
        }
        .section th, .section td {
            padding: 8px;
            text-align: center;
            border: 1px solid #ddd;
        }
        .section th {
            background-color: #f2f2f2;
        }

        /* 设置图片容器的grid布局 */
        .image-container {
            display: grid;
            gap: 20px; /* 设置图片之间的间距 */
            justify-items: center; /* 图片水平居中对齐 */
        }
        /* 设置文字描述的样式 */
        .image-container div p {
            text-align: center; /* 文字居中对齐 */
            font-size: 18px; /* 设置文字大小 */
            margin-top: 3px; /* 减少图片与文字之间的间距 */
        }
        /* 针对grid-image类的图片，设置大小 */
        .grid-image {
            width: 100%; /* 图片宽度自适应容器 */
            height: auto; /* 保持宽高比 */
            max-width: 1200px; /* 最大宽度设置为1200px，确保图片大小合适 */
        }
        
        /* 2张图片进行排列 */
        .image-container4 {
            display: grid;
            grid-template-columns: repeat(4, 1fr); /* 设置2列布局 */
            gap: 20px; /* 设置图片之间的间距 */
            justify-items: center; /* 图片水平居中对齐 */
        }
        /* 设置文字描述的样式 */
        .image-container4 div p {
            text-align: center; /* 文字居中对齐 */
            font-size: 24px; /* 设置文字大小 */
            margin-top: 3px; /* 减少图片与文字之间的间距 */
            font-weight: bold;
        }
        /* 针对grid-image类的图片，设置大小 */
        .grid-image4 {
            width: 100%; /* 图片宽度自适应容器 */
            height: auto; /* 保持宽高比 */
            max-width: 1400px; /* 最大宽度设置为1200px，确保图片大小合适 */
        }
        /* 4张图片进行排列 */

        /* 2张图片进行排列 */
        .image-container2 {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* 设置2列布局 */
            gap: 20px; /* 设置图片之间的间距 */
            justify-items: center; /* 图片水平居中对齐 */
        }
        .image-container2 img {
            width: 100%;
            height: 500px; /* 固定高度 */
            object-fit: scale-down;
        }
        /* 设置文字描述的样式 */
        .image-container2 div p {
            text-align: center; /* 文字居中对齐 */
            font-size: 24px; /* 设置文字大小 */
            margin-top: 3px; /* 减少图片与文字之间的间距 */
            font-weight: bold;
        }
        /* 针对grid-image类的图片，设置大小 */
        .grid-image2 {
            width: 100%; /* 图片宽度自适应容器 */
            height: auto; /* 保持宽高比 */
            max-width: 1000px; /* 最大宽度设置为1200px，确保图片大小合适 */
        }
        /* 2张图片进行排列 */

        /* 2张图片进行排列另一种写法*/
        .image-container22 {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* 设置2列布局 */
            gap: 30px; /* 设置图片之间的间距 */
            justify-items: center; /* 图片水平居中对齐 */
        }
        /* 设置文字描述的样式 */
        .image-container22 div p {
            text-align: center; /* 文字居中对齐 */
            font-size: 24px; /* 设置文字大小 */
            margin-top: 3px; /* 减少图片与文字之间的间距 */
            font-weight: bold;
        }
        /* 针对grid-image类的图片，设置大小 */
        .grid-image22 {
            width: 100%; /* 图片宽度自适应容器 */
            height: auto; /* 保持宽高比 */
            max-width: 1200px; /* 最大宽度设置为1200px，确保图片大小合适 */
        }
        /* 2张图片进行排列 */


        /* 8张图片进行排列 */
        .image-container8 {
            display: grid;
            grid-template-columns: repeat(4, 1fr); /* 设置4列布局 */
            gap: 20px; /* 设置图片之间的间距 */
            justify-items: center; /* 图片水平居中对齐 */
        }
        /* 设置文字描述的样式 */
        .image-container8 div p {
            text-align: center; /* 文字居中对齐 */
            font-size: 18px; /* 设置文字大小 */
            margin-top: 3px; /* 减少图片与文字之间的间距 */
        }
        /* 针对grid-image类的图片，设置大小 */
        .grid-image8 {
            width: 100%; /* 图片宽度自适应容器 */
            height: auto; /* 保持宽高比 */
            max-width: 1400px; /* 最大宽度设置为1200px，确保图片大小合适 */
        }
        /* 8张图片进行排列 */

        /* 6张图片进行排列 */
        .image-container6 {
            display: grid;
            grid-template-columns: repeat(3, 1fr); /* 设置4列布局 */
            gap: 20px; /* 设置图片之间的间距 */
            justify-items: center; /* 图片水平居中对齐 */
        }
        /* 设置文字描述的样式 */
        .image-container6 div p {
            text-align: center; /* 文字居中对齐 */
            font-size: 18px; /* 设置文字大小 */
            margin-top: 2px; /* 减少图片与文字之间的间距 */
        }
        /* 针对grid-image类的图片，设置大小 */
        .grid-image6 {
            width: 100%; /* 图片宽度自适应容器 */
            height: auto; /* 保持宽高比 */
            max-width: 1600px; /* 最大宽度设置为1200px，确保图片大小合适 */
        }
        /* 6张图片进行排列 */


    </style>

</head>

<body>
    <!-- title and author -->
    <section class="hero">
        <div class="hero-body">
            <div class="container is-max-desktop">
                <div class="columns is-centered">
                    <div class="column has-text-centered">
                        <h1 class="title is-1 publication-title">
                            华为火花 - 超长序列视频推理加速
                        </h1>

                        <div class="is-size-5 publication-authors">
                            <!-- <span class="author-block">*Under Review</span> -->
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </section>

    
    <!-- abstract -->
    <section class="section hero is-light" style="background: linear-gradient(135deg, #f0f8ff, #ffffff);">
        <div class="container is-max-desktop">
            <div class="columns is-centered has-text-centered">
                <div class="column is-four-fifths">
                    <h2 class="title is-3" style="color: #333; font-weight: bold;">火花奖技术诉求</h2>
                    <p style="color: #666; line-height: 1.6; font-weight: bold;">
                        提供面向超长序列（百万级）视频生成的推理加速关键技术：
                    </p>
                    <ul style="list-style-type: disc; padding-left: 2\5px; color: #555;">
                        <li>该技术需支持一次性生成场景和自回归生成场景的计算加速（包括但不限于稀疏化、序列压缩），并保证几乎无损，理论计算加速达到2x。</li>
                        <li>该技术需要设计序列并行技术，支持多卡扩展降低单卡计算量与峰值内存，并要求并行线性比>80%，8卡相比单卡并行理论加速6x以上。</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <br>
    <br>
    <br>
    <br>
    <br>
    
    <div class="container has-text-centered">
        <h2 class="title is-3">现阶段取得进展</h2>
        <div class="content has-text-justified">
        </div>
        <h2 class="title is-4">1. 并行加速 视频生成效果</h2>
        
        <br>

        <div class="video-container">
            <div>
                <video autoplay controls muted loop>
                    <source src="static/videos/HunyuanVideo/STA/2025-03-10-11-53-25_gentime642.1794936656952_timestp_50_An extreme close-up of an gray-haired man with a beard in his 60s, he is deep in thought pondering t.mp4" type="video/mp4" />
                </video>
                    <h2 class="subtitle has-text-centered italic">
                            HunYuan大模型单卡生成效果
                    </h2>
                    <h4 class="subtitle has-text-centered italic">
                        耗时1726.54s
                    </h4>
            </div>
            <div>
                <video autoplay controls muted loop>
                    <source src="static/videos/HunyuanVideo/STA_multiwindow_v2_timestep15/2025-03-10-11-39-13_gentime1124.5366597175598_timestp_50_An extreme close-up of an gray-haired man with a beard in his 60s, he is deep in thought pondering t.mp4" type="video/mp4" />
                </video>
                    <h2 class="subtitle has-text-centered italic">
                            新Pattern生成效果(耗时1124.53s)
                    </h2>
                    <h4 class="subtitle has-text-centered italic">
                        相比HunYuan大模型端到端加速1.53倍，attention计算平均加速2.2倍
                    </h4>
            </div>
            <div>
                <video autoplay controls muted loop>
                    <source src="static/videos/2025-03-10-21-08-46_gentime707.894357919693_timestp_50_An extreme close-up of an gray-haired man with a beard in his 60s, he is deep in thought pondering t.mp4" type="video/mp4" />
                </video>
                    <h2 class="subtitle has-text-centered italic">
                            新Pattern+双卡head并行(耗时707.89s)
                    </h2>
                    <h4 class="subtitle has-text-centered italic">
                            相比HunYuan大模型加速2.44倍
                    </h4>
            </div>
            
             
        </div>

            <p style="color: #666; line-height: 1.4; padding-top: 20px;">Prompt: An extreme close-up of an gray-haired man with a beard in his 60s, he is deep in thought pondering the history of the universe as he sits at a cafe in Paris, his eyes focus on people offscreen as they walk as he sits mostly motionless, he is dressed in a wool coat suit coat with a button-down shirt, he wears a brown beret and glasses and has a very professorial appearance, and the end he offers a subtle closed-mouth smile as if he found the answer to the mystery of life, the lighting is very cinematic with the golden light and the Parisian streets and city in the background, depth of field, cinematic 35mm film.
            </p>
        <br>

        <div class="grid-image">
            <div>
                <img src="static/images/fuzai_junheng.png" class="grid-image2" alt="Image 1">
            </div>
            
        </div>
        <p >半窗口：稀疏率=50%   满窗口：不做稀疏化，稀疏率=100% 
        </p>
        <!-- <p>重排：根据head的负载情况进行均匀分配，以确保各GPU上的负载差距尽可能小</p> -->

        <br>
        <br>
        <br>
        <br>
        <br>
        <br>

        <h2 class="title is-4">2. 新Pattern 视频生成效果</h2>

        <p style="color: #666; line-height: 1.4; padding-top: 20px;">attention计算在平均时间上相比flash_v2，有2.3倍的加速</p>

        <p>STA中针对十字型head大部分都选取了最大的window size进行计算，现在我们使用了多窗口来计算十字型head，
            取得更好的视觉效果
        </p>
        
        <div class="video-container">
            <div>
                <video autoplay controls muted loop>
                    <source src="static/videos/HunyuanVideo/ori/2025-03-04-20-12-30_gentime1721.5763249397278_timestp_50_A cat walks on the grass, realistic style._ori.mp4" type="video/mp4" />
                </video>
                    <h2 class="subtitle has-text-centered italic">
                            HunYuan大模型生成效果(耗时1721.57s)
                    </h2>
            </div>
            <div>
                <video autoplay controls muted loop>
                    <source src="static/videos/HunyuanVideo/STA/2025-03-05-15-28-06_gentime623.8373334407806_timestp_50_A cat walks on the grass, realistic style..mp4" type="video/mp4" />
                </video>
                    <h2 class="subtitle has-text-centered italic">
                            STA单窗口 (耗时623.83s)
                    </h2>
            </div>
            <div>
                <video autoplay controls muted loop>
                    <source src="static/videos/HunyuanVideo/STA_multiwindow_v2_timestep15/2025-03-09-18-49-21_gentime1118.895164012909_timestp_50_A cat walks on the grass, realistic style..mp4" type="video/mp4" />
                </video>
                    <h2 class="subtitle has-text-centered italic">
                        新Pattern (耗时1118.89s),相比HunYuan整体加速1.54倍，attention计算平均加速2.2倍
                    </h2>
            </div>
            
        </div>
        
        <br>

        <div class="grid-image">
            <div>
                <img src="static/images/cat_multiwindows.png" class="grid-image2" alt="Image 1">
                
            </div>
            
        </div>
        
        <br>
        <br>
        <h2 class="subtitle has-text-centered italic">
            长文本
        </h2>
        
        <div class="video-container">
            <div>
                <video autoplay controls muted loop>
                    <source src="static/videos/2025-03-10-12-46-44_gentime1726.5414171218872_timestp_50_An extreme close-up of an gray-haired man with a beard in his 60s, he is deep in thought pondering t.mp4" type="video/mp4" />
                </video>
                    <h2 class="subtitle has-text-centered italic">
                            HunYuan大模型生成效果(耗时1726.54s)
                    </h2>
            </div>
            <div>
                <video autoplay controls muted loop>
                    <source src="static/videos/2025-03-10-11-53-25_gentime642.1794936656952_timestp_50_An extreme close-up of an gray-haired man with a beard in his 60s, he is deep in thought pondering t.mp4" type="video/mp4" />
                </video>
                    <h2 class="subtitle has-text-centered italic">
                            STA单窗口 (耗时642.17s)
                    </h2>
            </div>
            <div>
                <video autoplay controls muted loop>
                    <source src="static/videos/2025-03-10-11-39-13_gentime1124.5366597175598_timestp_50_An extreme close-up of an gray-haired man with a beard in his 60s, he is deep in thought pondering t.mp4" type="video/mp4" />
                </video>
                    <h2 class="subtitle has-text-centered italic">
                            多窗口生成效果(耗时1124.53s)，加速1.53倍
                    </h2>
            </div>
        </div>
        <p style="color: #666; line-height: 1.4; padding-top: 20px;">Prompt: An extreme close-up of an gray-haired man with a beard in his 60s, he is deep in thought pondering the history of the universe as he sits at a cafe in Paris, his eyes focus on people offscreen as they walk as he sits mostly motionless, he is dressed in a wool coat suit coat with a button-down shirt, he wears a brown beret and glasses and has a very professorial appearance, and the end he offers a subtle closed-mouth smile as if he found the answer to the mystery of life, the lighting is very cinematic with the golden light and the Parisian streets and city in the background, depth of field, cinematic 35mm film.
        </p>
        <br>
        <div class="grid-image">
            <div>
                <img src="static/images/grayman.png" class="grid-image2" alt="Image 1">
    
            </div>
            
        </div>

        <br> 
        
 
        <!-- 四个视频结束 -->
        <div class="video-container">
            <div>
                <video autoplay controls muted loop>
                    <source src="static/videos/2025-03-11-21-00-53_gentime1726.1180930137634_timestp_50_a close-up shot of a woman standing in a dimly lit room. she is wearing a traditional chinese outfit.mp4" />
                </video>
                    <h2 class="subtitle has-text-centered italic">
                            HunYuan大模型生成效果(耗时1726.11s)
                    </h2>
            </div>
            <div>
                <video autoplay controls muted loop>
                    <source src="static/videos/2025-03-11-21-24-44_gentime638.1768188476562_timestp_50_a close-up shot of a woman standing in a dimly lit room. she is wearing a traditional chinese outfit.mp4" type="video/mp4" />
                </video>
                    <h2 class="subtitle has-text-centered italic">
                            STA单窗口 (耗时638.17s)
                    </h2>
            </div>
            <div>
                <video autoplay controls muted loop>
                    <source src="static/videos/2025-03-11-21-45-31_gentime1147.4892847537994_timestp_50_a close-up shot of a woman standing in a dimly lit room. she is wearing a traditional chinese outfit.mp4" type="video/mp4" />
                </video>
                    <h2 class="subtitle has-text-centered italic">
                        新Pattern(耗时1147.48s)，相比HunYuan整体加速1.50倍，attention计算平均加速2.2倍
                    </h2>
            </div>
            
            
        </div>
        <p style="color: #666; line-height: 1.4; padding-top: 20px;">Prompt: a close-up shot of a woman standing in a dimly lit room. she is wearing a traditional chinese outfit, which includes a red and gold dress with intricate designs and a matching headpiece. the woman has her hair styled in an updo, adorned with a gold accessory. her makeup is done in a way that accentuates her features, with red lipstick and dark eyeshadow. she is looking directly at the camera with a neutral expression. the room has a rustic feel, with wooden beams and a stone wall visible in the background. the lighting in the room is soft and warm, creating a contrast with the woman's vibrant attire. there are no texts or other objects in the video. the style of the video is a portrait, focusing on the woman and her attire.
        </p>
        <br>
        <div class="grid-image">
            <div>
                <img src="static/images/woman.png" class="grid-image2" alt="Image 1">
            </div>
            
        </div>
        <br>
        <div class="grid-image">
            <div>
                <img src="static/images/qingting.png" class="grid-image2" alt="Image 1">
    
            </div>
            
        </div>
        <!-- <div class="centered-content">
            <img src="static/images/cross_notfull_recall.jpg" style="width: 50%; height: auto;" />                    
        </div> -->

        <br>
        
        <!-- <div class="centered-content">
            <img src="static/images/cross_notfull_recall.jpg" style="width: 50%; height: auto;" />                    
        </div> -->
        <div class="grid-image">
            <div>
                <img src="static/images/bird.png" class="grid-image2" alt="Image 1">
            </div>
            
        </div>
        <br>
        <br>
        <br>
        <br>

        <br>
        <br>
        <br>
        <br>
        <br>

        <div>
            <h2 class="title is-4">3.对单个head进行不同Pattern，不同稀疏率下的召回率分析</h2>
            <p style="margin: 0 auto;">对同一个head在不同pattern下进行实验，测试不同稀疏率带来的召回率收益
            </p>
            <br>

            <h2 class="title is-5">十字形注意力头</h2>
            <div class="content has-text-justified"  style="margin: 0 auto;">
                <div class="image-container">
                    <div>
                        <img src="static/images/Attn_Vis/cross_recall_table1.jpg" class="grid-image2" alt="Image 1">
                    </div>
                    <p>要达到95%以上的召回率，局部性窗口需要300的计算量，而十字形窗口只需要155，计算速度可以加速2倍。
                    </p>
                </div>
                
                <div class="image-container">
                    <div>
                        <img src="static/images/Attn_Vis/cross_recall_table2.jpg" class="grid-image2" alt="Image 1">
                    </div>
                    <p>要达到94%以上的召回率，局部性窗口需要45的计算量，而十字形窗口只需要25，计算速度可以加速约2倍。
                    </p>
                </div>
                <div class="image-container">
                    <div>
                        <img src="static/images/Attn_Vis/cross_recall_table3.jpg" class="grid-image2" alt="Image 1">
                    </div>
                    <p>要达到90%以上的召回率，局部性窗口需要125的计算量，而十字形窗口只需要25，计算速度可以加速约4.5倍。
                    </p>
                </div>
                <br>

                <!-- <p style="margin: 0 auto;">timestep 40, layer 10, head 22</p> -->
                
                <div class="image-container2">
                    <div>
                        <img src="static/images/timestep40_layer20_head11.png.png" class="grid-image2" alt="Image 1">
                    </div>
                    <div>
                        <img src="static/images/t40lay20head11.png" class="grid-image2" alt="Image 1">
                        <!-- 添加文字描述 -->
                    </div>
                    <p>timestep40_layer20_head11</p>
                    <p>视频总大小fhw=[30,48,80]，可视化图是像素点[15,24,40]对其他所有像素点的关注情况，按[48,80]为一帧，将30帧排布为[5,6]</p>
                </div>
            </div>
            

            <br>
            <br>

            <h2 class="title is-5">在时序上存在变化的注意力头</h2>
            <div>
                <div class="image-container">
                    <div>
                        <img src="static/images/Attn_Vis/time_recall_table1.jpg" class="grid-image2" alt="Image 1">
                        <p>要达到80%以上的召回率，局部性窗口需要300的计算量，而十字形窗口只需要165，计算速度可以加速1.84127倍。
                    </div>
                </div>
                <div class="image-container">
                    <div>
                        <img src="static/images/Attn_Vis/time_recall_table2.jpg" class="grid-image2" alt="Image 1">
                        <p>要达到95%以上的召回率，局部性窗口需要300的计算量，而十字形窗口只需要151，计算速度可以加速2.034483倍。
                    </div>
                </div>
                <div class="image-container">
                    <div>
                        <img src="static/images/Attn_Vis/time_recall_table3.jpg" class="grid-image2" alt="Image 1">
                        <p>要达到80%以上的召回率，局部性窗口需要300的计算量，而十字形窗口只需要123，计算速度可以加速2.416667倍。
                    </div>
                </div>

                <div class="image-container2">
                    <div>
                        <img src="static/images/Attn_Vis/timestep40_layer20_head0.png.png" class="grid-image2" alt="Image 1">
                    </div>
                    
                    <div>
                        <img src="static/images/Attn_Vis/time_recall_table11.jpg" class="grid-image2" alt="Image 1">
                        <!-- 添加文字描述 -->
                    </div>
                </div>
            </div>
            
        </div>

        <br>
        <br>
        <br>
        <br>






        
        <div>
            <h2 class="title is-5" style="text-align: center;">十字型pattern</h2>
            <div class="image-container4">
                <div>
                    <img src="static/images/timestep30_layer0_head11.png" class="grid-image4" alt="Image 1">
                    <p>timestep0  layer6 head4</p> <!-- 添加文字描述 -->
                </div>
                <div>
                    <img src="static/images/timestep20_layer30_head13.png" class="grid-image4" alt="Image 2">
                    <p>timestep0   layer4 head7</p> <!-- 添加文字描述 -->
                </div>
                <div>
                    <img src="static/images/timestep20_layer39_head18.png" class="grid-image4" alt="Image 3">
                    <p>timestep10 layer24 head21</p> <!-- 添加文字描述 -->
                </div>
                <div>
                    <img src="static/images/timestep20_layer10_head10.png" class="grid-image4" alt="Image 4">
                    <p>timestep30 layer0 head11</p> <!-- 添加文字描述 -->
                </div>
                
            </div>

        </div>

        <div>
            <!-- <img src="static/images/aaa.jpg"/> -->
            <p>As shown in Figure 3 left, despite training with full 3D atten tion, HunyuanVideo exhibits strong locality: on average, a local window covering only 15.52% of the total token space accounts for 70%of the total attention score.</p>
        </div>
        <div class="container has-text-centered">
            <h2 class="title is-3">
                局部性滑动窗口
                <br>
            </h2>
            
            <div style="display: flex; justify-content: space-around; align-items: center;">
                <div>
                    <img src="static/images/jubuxing1.jpg" class="grid-image2" alt="Image 1" />
                    <!-- <p>timestep XX</p> -->
                </div>
                <div>
                    <img src="static/images/jubuxing2.jpg" class="grid-image2" alt="Image 3" />
                    <!-- <p>timestep 40</p> -->
                </div>
            </div>

            <br>

            <h2 class="title is-3">
                multi-window处理十字型attention pattern
            </h2>
            <div class="centered-content">
                    <img src="static/images/multi_window.jpg" style="width: 50%; height: auto;" />                    
                </div>
            
            
        </div>

        <h2 class="title is-4">
            VBENCH生成质量
            <br>
        </h2>
    
        <table border="1" >
            
            <thead>
              <tr>
                <th>Method</th>
                <th>Config</th>
                <th>VBench Quality</th>
                <th>Latency</th>
                <th>Speedup</th>
              </tr>
            </thead>
          
            
            <tbody>
              <tr>
                <td>FA2</td>
                <td>-</td>
                <td>85.34%</td>
                <td>1496s</td>
                <td>0.63x</td>
              </tr>
              <tr>
                <td>FA3</td>
                <td>-</td>
                <td>85.34%</td>
                <td>945s</td>
                <td>1.00x</td>
              </tr>
              <tr>
                <td>3D Locality</td>
                <td>w=(30,40,40)</td>
                <td>84.63%</td>
                <td>527s</td>
                <td>1.79x</td>
              </tr>
              <tr>
                <td>3D Locality</td>
                <td>w=(18,24,24)</td>
                <td>81.47%</td>
                <td>268s</td>
                <td>3.53x</td>
              </tr>
            </tbody>
          </table>
          
    </div>
    
        <!-- <h2 class="title is-4">斜线pattern的不同膨胀</h2>
        <div style="display: flex; justify-content: space-around; align-items: center;">
            <div>
                <img src="static/images/slash1.jpg" class="grid-image22" alt="Image 1" />
            </div>
            <div>
                <img src="static/images/slash2.jpg" class="grid-image22" alt="Image 3" />
            </div>
        </div> -->


        <h2 class="title is-4">
            <a href="https://huggingface.co/spaces/Vchitect/VBench_Leaderboard" target="_blank">
                VBENCH指标表
            </a>
        </h2>
        <img src="static/images/table.jpg" /> <br>
        <a href="https://vchitect.github.io/VBench-project/">VBench github链接</a> <br>
        <img src="static/images/vbench_opensource.jpg" />


    <br>
    
    <p>
        本阶段主要针对论文《Fast Video Generation with SLIDING TILE ATTENTION》进行优化，该论文实现了inference 10x的加速，但是存在如下两个问题：<br>
        1.尽管大部分head的attention recall在80%以上，但仍有一部分head的召回率仅有30%左右。<br>
        2.不同timestep、prompt的attention sparse pattern可能不同，并且即使都是斜线，但是斜线的膨胀也可能不同
    </p>
    <p style="font-weight: bold;">参考文献:</p>
    <p>
        <span style="font-weight: bold; font-style: italic;">[1]</span> Zhang P, Chen Y, Su R, et al. Fast Video Generation with Sliding Tile Attention[J]. arXiv preprint arXiv:2502.04507, 2025. <br>
        <span style="font-weight: bold; font-style: italic;">[2]</span> Huang Z, He Y, Yu J, et al. Vbench: Comprehensive benchmark suite for video generative models[C]//Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition. 2024: 21807-21818. <br>
        <span style="font-weight: bold; font-style: italic;">[3]</span> Kong W, Tian Q, Zhang Z, et al. Hunyuanvideo: A systematic framework for large video generative models[J]. arXiv preprint arXiv:2412.03603, 2024. <br>
        <span style="font-weight: bold; font-style: italic;">[4]</span> Zheng Z, Peng X, Yang T, et al. Open-sora: Democratizing efficient video production for all[J]. arXiv preprint arXiv:2412.20404, 2024. <br>
        <span style="font-weight: bold; font-style: italic;">[5]</span> Dao T. Flashattention-2: Faster attention with better parallelism and work partitioning[J]. arXiv preprint arXiv:2307.08691, 2023. <br>
        <span style="font-weight: bold; font-style: italic;">[6]</span> Shah, Jay, et al. "Flashattention-3: Fast and accurate attention with asynchrony and low-precision." Advances in Neural Information Processing Systems 37 (2025): 68658-68685. <br>
    </p>

    <!-- Pattern 分析 -->
    <section class="section hero">

        <!-- transition -->
        <div class="container has-text-centered">
            <h2 class="title is-3">Attention Map 特点</h2>

            <h2 class="title is-4">Attention Map 稀疏性</h2>
            <div style="display: flex; justify-content: space-around; align-items: center;">
                <div>
                    <img src="static/images/timestepXX.jpg" class="grid-image2" alt="Image 1" />
                    <p>timestep XX</p>
                </div>
                <div>
                    <img src="static/images/timestep_40.jpg" class="grid-image2" alt="Image 3" />
                    <p>timestep 40</p>
                </div>
            </div>

            <br>

            <!-- step 6 -->
    <div class="container has-text-centered">
        <h2 class="title is-3">
            Attention Map分类
            <br>
        </h2>
        
        <!-- 添加小标题 3D locality -->
        <h3 class="title is-4">3D locality：关注局部信息</h3>  <!-- 小标题部分 -->

        <!-- 3D -->
        <div class="image-container8">
            <div>
                <img src="static/images/3D/timestep0_layer6_batch1_head21.png" class="grid-image8" alt="Image 1">
                <p>timestep0 layer6 head21</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/3D/timestep0_layer12_batch1_head0.png" class="grid-image8" alt="Image 2">
                <p>timestep0 layer12 head0</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/3D/timestep20_layer6_batch1_head10.png" class="grid-image8" alt="Image 3">
                <p>timestep20 layer6 head10</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/3D/timestep20_layer6_batch1_head21.png" class="grid-image8" alt="Image 4">
                <p>timestep20 layer6 head21</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/3D/timestep20_layer24_batch1_head2.png" class="grid-image8" alt="Image 5">
                <p>timestep20 layer24 head2</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/3D/timestep30_layer24_batch1_head2.png" class="grid-image8" alt="Image 6">
                <p>timestep30 layer24 head2</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/3D/timestep40_layer0_batch1_head1.png" class="grid-image8" alt="Image 6">
                <p>timestep40 layer0 head1</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/3D/timestep40_layer0_batch1_head4.png" class="grid-image8" alt="Image 6">
                <p>timestep40 layer0 head4</p> <!-- 添加文字描述 -->
            </div>
        </div>
        
        <br>
        
        <!-- 添加小标题 全局 -->
        <h3 class="title is-4">全局性：主要关注全局信息</h3>  <!-- 小标题部分 -->

        <!-- 全局 -->
        <div class="image-container6">
            <div>
                <img src="static/images/quanju/timestep0_layer6_batch1_head4.png" class="grid-image6" alt="Image 1">
                <p>timestep0 layer6 head4</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/quanju/timestep0_layer6_batch1_head7.png" class="grid-image6" alt="Image 2">
                <p>timestep0 layer4 head7</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/quanju/timestep10_layer24_batch1_head21.png" class="grid-image6" alt="Image 3">
                <p>timestep10 layer24 head21</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/quanju/timestep30_layer0_batch1_head11.png" class="grid-image6" alt="Image 4">
                <p>timestep30 layer0 head11</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/quanju/timestep40_layer0_batch1_head20.png" class="grid-image6" alt="Image 5">
                <p>timestep40 layer0 head20</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/quanju/timestep49_layer0_batch1_head11.png" class="grid-image6" alt="Image 6">
                <p>timestep49 layer0 head11</p> <!-- 添加文字描述 -->
            </div>
        </div>
        
        <br>
        
        <!-- 添加小标题 十字 -->
        <h3 class="title is-4">十字形</h3>  <!-- 小标题部分 -->

        <!-- 全局 -->
        <div class="image-container6">
            <div>
                <img src="static/images/shizi/timestep0_layer6_batch1_head2.png" class="grid-image6" alt="Image 1">
                <p>timestep0 layer6 head2</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/shizi/timestep0_layer30_batch1_head9.png" class="grid-image6" alt="Image 2">
                <p>timestep0 layer30 head9</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/shizi/timestep0_layer30_batch1_head10.png" class="grid-image6" alt="Image 3">
                <p>timestep0 layer30 head10</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/shizi/timestep0_layer30_batch1_head17.png" class="grid-image6" alt="Image 4">
                <p>timestep0 layer30 head17</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/shizi/timestep10_layer30_batch1_head12.png" class="grid-image6" alt="Image 5">
                <p>timestep10 layer30 head12</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/shizi/timestep40_layer0_batch1_head12.png" class="grid-image6" alt="Image 6">
                <p>timestep40 layer0 head12</p> <!-- 添加文字描述 -->
            </div>
        </div>
        
        <br>
        
        <!-- 添加小标题 格点 -->
        <h3 class="title is-4">格点</h3>  <!-- 小标题部分 -->

        <!-- 格点 -->
        <div class="image-container6">
            <div>
                <img src="static/images/gedian/timestep0_layer12_batch1_head1.png" class="grid-image6" alt="Image 1">
                <p>timestep0 layer12 head1</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/gedian/timestep0_layer6_batch1_head11.png" class="grid-image6" alt="Image 2">
                <p>timestep0 layer6 head11</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/gedian/timestep20_layer6_batch1_head11.png" class="grid-image6" alt="Image 3">
                <p>timestep20 layer6 head11</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/gedian/timestep30_layer6_batch1_head11.png" class="grid-image6" alt="Image 4">
                <p>timestep30 layer6 head11</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/gedian/timestep40_layer0_batch1_head8.png" class="grid-image6" alt="Image 5">
                <p>timestep40 layer0 head8</p> <!-- 添加文字描述 -->
            </div>
        </div>
        
        <br>
    </div>

            <br>

        </div>

    </section>
    
    <div class="container has-text-centered">
        <h2 class="title is-3">
            Attention Map分析
            <br>
        </h2>
        
        <!-- 添加色条图片并旋转90度 -->
        <div style="display: flex; justify-content: center; margin-bottom: 0; margin-top: 5;">
            <img src="static/images/total.jpg" style="width: 90px; transform: rotate(90deg); margin-top: -320px; margin-bottom: -310px;" alt="Color Bar">
        </div>

        <div class="image-container">
            <div>
                <img src="static/images/timestep0.jpg" class="grid-image" alt="Image 1">
                <p>timestep 0</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/timestep10.jpg" class="grid-image" alt="Image 2">
                <p>timestep 10</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/timestep20.jpg" class="grid-image" alt="Image 3">
                <p>timestep 20</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/timestep30.jpg" class="grid-image" alt="Image 4">
                <p>timestep 30</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/timestep40.jpg" class="grid-image" alt="Image 5">
                <p>timestep 40</p> <!-- 添加文字描述 -->
            </div>
            <div>
                <img src="static/images/timestep49.jpg" class="grid-image" alt="Image 6">
                <p>timestep 49</p> <!-- 添加文字描述 -->
            </div>
        </div>
        
        <br>

    </div>

    <br>

    <!-- Method 1 -->
    <!-- <div class="container has-text-centered">
        <h2 class="title is-3">Method</h2>
    </div>

    <br> -->

    <!-- step 1 -->
    <!-- <div class="container has-text-centered">
        <h2 class="title is-4">Step 1: 离线分析pattern</h2>

        <div class="video-container">
            <div style="display: flex; justify-content: space-around; align-items: center;">
                <img src="static/images/slash1.jpg" style="width: 30%;" alt="Image 1" />
                <img src="static/images/pattern2.jpg" style="width: 30%;" alt="Image 2" />
                <img src="static/images/pattern3.jpg" style="width: 30%;" alt="Image 3" />
            </div>
        </div>
    </div>

    <br>
    <br>
    <br> -->

    <!-- step 2 -->
    <!-- <section class="hero teaser">
        <div class="container is-max-desktop">
            <div class="hero-body">
                    <h2 class="title is-4" style="text-align: center;">
                        Step 2: 3D局部性注意力
                    </h2>
                <img src="static/images/align.jpg" style="width: 100%; display: block; margin: 0 auto; max-width: none;" />
            </div>
        </div>
    </section> -->

    <!-- step 3 -->
    <!-- <div class="container has-text-centered">
        <h2 class="title is-3" style="text-align: center;">
            Step 3 (Inference)
            <br>
            Render Preview Video Along the Camera Trace on the Reconstructed 3D Scene
        </h2>

        <div class="video-container">
            <video autoplay controls muted loop>
                <source src="static/videos/preview_video/preview1.mp4" type="video/mp4" />
            </video>

            <video autoplay controls muted loop>
                <source src="static/videos/preview_video/preview2.mp4" type="video/mp4" />
            </video>

            <video autoplay controls muted loop>
                <source src="static/videos/preview_video/preview3.mp4" type="video/mp4" />
            </video>
        </div>
    </div>

    <br> -->

    <!-- step 4
    <div class="container has-text-centered">
            <h2 class="title is-3">
                Step 4 Fast Video Generation with SLIDING TILE ATTENTION
                <br>
                SAT
            </h2>
        <div class="content has-text-justified">
            We paste the visible latents of preview video into the predicted latent during generation process. However, we only paste on the high noise level and allow for
            dynamics in lower level of noise, thus we name it "noise shaping" that only shapes the noise at the initial high noise stage.
        </div>
            <div class="video-container">
                <div>
            <video autoplay controls muted loop>
                <source src="static/videos/ablation/ablation1_preview.mp4" type="video/mp4" />
            </video>
                    <h2 class="subtitle has-text-centered italic">
                        Preview Video
                    </h2>
        </div>

                <div>
            <video autoplay controls muted loop>
                <source src="static/videos/ablation/ablation1_withNoiseShaping.mp4" type="video/mp4" />
            </video>
                    <h2 class="subtitle has-text-centered italic">
                        Scene-Constrained Noise Shaping
                    </h2>
        </div>


                <div>
            <video autoplay controls muted loop>
                <source src="static/videos/ablation/ablation1_withoutNoiseShaping.mp4" type="video/mp4" />
            </video>
                    <h2 class="subtitle has-text-centered italic">
                        No Scene-Constrained Noise Shaping
                    </h2>
                </div>
        </div>
        <br>


    </div> -->

    <!-- VBENCH生成质量 -->
    <!-- <div class="container has-text-centered">
        <h2 class="title is-3">
            Step 2 VBENCH生成质量
            <br>
        </h2>
    
        <table border="1" >
            
            <thead>
              <tr>
                <th>Method</th>
                <th>Config</th>
                <th>VBench Quality</th>
                <th>Latency</th>
                <th>Speedup</th>
              </tr>
            </thead>
          
            
            <tbody>
              <tr>
                <td>FA2</td>
                <td>-</td>
                <td>85.34%</td>
                <td>1496s</td>
                <td>0.63x</td>
              </tr>
              <tr>
                <td>FA3</td>
                <td>-</td>
                <td>85.34%</td>
                <td>945s</td>
                <td>1.00x</td>
              </tr>
              <tr>
                <td>3D Locality</td>
                <td>w=(30,40,40)</td>
                <td>84.63%</td>
                <td>527s</td>
                <td>1.79x</td>
              </tr>
              <tr>
                <td>3D Locality</td>
                <td>w=(18,24,24)</td>
                <td>81.47%</td>
                <td>268s</td>
                <td>3.53x</td>
              </tr>
            </tbody>
          </table>
          
    </div>

    <br> -->

    

    <br>

    <!-- step 3 -->
    


</div>



</body>

</html>